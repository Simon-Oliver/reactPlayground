{"ast":null,"code":"var _jsxFileName = \"/Users/Simon/Desktop/Coding/reactplayground/client/src/components/Chat.js\";\nimport React, { Component } from 'react';\nimport io from 'socket.io-client';\nimport Login from './Login';\nexport default class Chat extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      response: 0,\n      endpoint: 'http://192.168.1.105:5000/',\n      userName: '',\n      userId: '',\n      users: [],\n      loggedIn: false,\n      message: '',\n      messages: [],\n      error: ''\n    };\n    this.socket = io.connect(this.state.endpoint, {\n      query: {\n        token: sessionStorage.token\n      }\n    });\n\n    this.sendEmit = userName => {\n      this.socket.emit('create_user', userName);\n    };\n\n    this.sendMessage = message => {\n      console.log(message);\n      this.setState({\n        message\n      }, () => {\n        this.socket.emit('message', {\n          userName: this.state.userName,\n          id: this.socket.id,\n          message: this.state.message\n        });\n      });\n    };\n  }\n\n  componentDidMount() {\n    console.log(sessionStorage); // Very simply connect to the socket\n    // Listen for data on the \"outgoing data\" namespace and supply a callback for what to do when we get one. In this case, we set a state variable\n    // this.socket.emit('init_data');\n    // this.socket.on('get_data', data =>\n    //   this.setState({ users: data.users, messages: data.messages })\n    // );\n    // this.socket.on('outgoing data', data => this.setState({ response: data.num }));\n    // this.socket.on('outgoing users', users => this.setState({ users }));\n    // this.socket.on('initUser', user => {\n    //   console.log('Init User Fired', user);\n    //   this.setState({ userName: user.userName });\n    //   sessionStorage.token = user.token;\n    //   console.log(sessionStorage);\n    // });\n    // this.socket.on('error', e => this.setState({ error: e }));\n\n    console.log(sessionStorage.token);\n\n    if (sessionStorage.token !== 'undefined' || sessionStorage.token) {\n      console.log('componenstDidMount with sesssionstorage');\n      this.socket.emit('auth_check');\n    }\n\n    this.socket.on('create_user', data => {\n      if (data.error) {\n        this.setState({\n          error: data.error\n        });\n      }\n\n      sessionStorage.token = data.token;\n      sessionStorage.userName = data.userName;\n      this.setState({\n        error: ''\n      });\n    });\n    this.socket.on('auth', e => console.log(e)); // this.socket.on('outgoing messages', message => {\n    //   console.log(message);\n    //   this.setState(prevState => ({ messages: [...prevState.messages, message] }));\n    // });\n    // this.socket.on('existing user', user =>\n    //   this.setState({ userName: user.userName, userId: user.userId })\n    // );\n  }\n\n  componentWillUnmount() {// this.socket.off('outgoing data');\n    // this.socket.off('outgoing users');\n  }\n\n  render() {\n    const isLoggedIn = this.state.error.type !== 'authentication_error';\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, isLoggedIn ? React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"Authenticated\") : React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"Not Authenticated\"), React.createElement(Login, {\n      loggedIn: this.state.loggedIn,\n      sendEmit: this.sendEmit,\n      users: this.state.users,\n      userName: this.state.userName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["/Users/Simon/Desktop/Coding/reactplayground/client/src/components/Chat.js"],"names":["React","Component","io","Login","Chat","state","response","endpoint","userName","userId","users","loggedIn","message","messages","error","socket","connect","query","token","sessionStorage","sendEmit","emit","sendMessage","console","log","setState","id","componentDidMount","on","data","e","componentWillUnmount","render","isLoggedIn","type"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport io from 'socket.io-client';\nimport Login from './Login';\n\nexport default class Chat extends Component {\n  state = {\n    response: 0,\n    endpoint: 'http://192.168.1.105:5000/',\n    userName: '',\n    userId: '',\n    users: [],\n    loggedIn: false,\n    message: '',\n    messages: [],\n    error: ''\n  };\n\n  socket = io.connect(this.state.endpoint, { query: { token: sessionStorage.token } });\n\n  componentDidMount() {\n    console.log(sessionStorage);\n    // Very simply connect to the socket\n    // Listen for data on the \"outgoing data\" namespace and supply a callback for what to do when we get one. In this case, we set a state variable\n    // this.socket.emit('init_data');\n    // this.socket.on('get_data', data =>\n    //   this.setState({ users: data.users, messages: data.messages })\n    // );\n    // this.socket.on('outgoing data', data => this.setState({ response: data.num }));\n    // this.socket.on('outgoing users', users => this.setState({ users }));\n    // this.socket.on('initUser', user => {\n    //   console.log('Init User Fired', user);\n    //   this.setState({ userName: user.userName });\n    //   sessionStorage.token = user.token;\n    //   console.log(sessionStorage);\n    // });\n    // this.socket.on('error', e => this.setState({ error: e }));\n    console.log(sessionStorage.token);\n    if (sessionStorage.token !== 'undefined' || sessionStorage.token) {\n      console.log('componenstDidMount with sesssionstorage');\n      this.socket.emit('auth_check');\n    }\n    this.socket.on('create_user', data => {\n      if (data.error) {\n        this.setState({ error: data.error });\n      }\n      sessionStorage.token = data.token;\n      sessionStorage.userName = data.userName;\n      this.setState({ error: '' });\n    });\n    this.socket.on('auth', e => console.log(e));\n    // this.socket.on('outgoing messages', message => {\n    //   console.log(message);\n    //   this.setState(prevState => ({ messages: [...prevState.messages, message] }));\n    // });\n    // this.socket.on('existing user', user =>\n    //   this.setState({ userName: user.userName, userId: user.userId })\n    // );\n  }\n\n  componentWillUnmount() {\n    // this.socket.off('outgoing data');\n    // this.socket.off('outgoing users');\n  }\n\n  sendEmit = userName => {\n    this.socket.emit('create_user', userName);\n  };\n\n  sendMessage = message => {\n    console.log(message);\n    this.setState({ message }, () => {\n      this.socket.emit('message', {\n        userName: this.state.userName,\n        id: this.socket.id,\n        message: this.state.message\n      });\n    });\n  };\n\n  render() {\n    const isLoggedIn = this.state.error.type !== 'authentication_error';\n\n    return (\n      <div>\n        {isLoggedIn ? <p>Authenticated</p> : <p>Not Authenticated</p>}\n        <Login\n          loggedIn={this.state.loggedIn}\n          sendEmit={this.sendEmit}\n          users={this.state.users}\n          userName={this.state.userName}\n        />\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}